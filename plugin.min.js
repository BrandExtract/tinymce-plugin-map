(()=>{(function(h){"use strict";h.PluginManager.requireLangPack("map");let l=["google_staticmap","google_embed"];l.google_staticmap={name:"Google Static Map",api:"//maps.googleapis.com/maps/api/staticmap?",type:"img"},l.google_embed={name:"Google Embed Map",api:"//www.google.com/maps/embed/v1/place?",type:"iframe"};let g=/^(?:color:)?([^|]*)(?:\|.*)?$/;function y(t,o){let n=[],e,i;for(e in o)i=o[e],i&&n.push(e+"="+i);return t+=n.join("&"),t}function m(t){let o=m.options,n=o.parser[o.strictMode?"strict":"loose"].exec(t),e={},i=14;for(;i--;)e[o.key[i]]=n[i]||"";return e[o.q.name]={},e[o.key[12]].replace(o.q.parser,function(s,r,c){r&&(e[o.q.name][r]=c)}),e}m.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};function u(t,o){let n=l[t.service||"google_staticmap"];if(!n)return"";let e=n.type;delete t.service;let i=t.width,a=t.height;t.size=i+"x"+a,t.scale&&(t.scale=2),t.markers&&(t.markers=t.markers.replace(g,"color:$1|"+t.center));let s=t.center||t.q;e==="iframe"&&(t.q=t.center,delete t.center,delete t.markers,delete t.width,delete t.height,delete t.size,delete t.scale,delete t.format),t.key||(t.key=n.key||"");let r=y(n.api,t);return r="<"+e+" src='"+r+"'",r+=" width='"+i+"' height='"+a+"'",e==="img"&&(r+=" alt='Map of "+s+"' title='"+s+"'"),o&&(r+=" style='max-width:100%;height:auto'"),r+=" />",r}function p(t,o){this.editor=t,this.url=o,l.forEach(function(e){let i=l[e];i.key=t.options.get(e+"_api_key")||""}),this.formFields=[{type:"listbox",name:"service",label:"Map service",tooltip:"Available: Google.",items:l.map(function(e){return{text:l[e].name,value:e}})},{type:"input",name:"key",label:"API Key"},{type:"input",name:"center",label:"Location",tooltip:"This parameter takes a location as either a comma-separated {latitude,longitude} pair (e.g. '40.714728,-73.998672') or a string address (e.g. 'city hall, new york, ny') identifying a unique location on the face of the earth"},{type:"grid",columns:2,items:[{type:"listbox",name:"zoom",label:"Zoom level",tooltip:"This parameter takes a numerical value corresponding to the zoom level of the region desired",items:["10","11","12","13","14","15","16","17","18","19","20"].map(function(e){return{text:e,value:e+""}})},{type:"listbox",name:"markers",label:"Marker",items:["No marker","black","brown","green","purple","yellow","blue","gray","orange","red","white"].map(function(e,i){return{text:e,value:i===0?"":e}})}]},{type:"grid",columns:2,items:[{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]},{type:"checkbox",label:"Retina (2x)",name:"retina"},{type:"listbox",name:"maptype",label:"Map type",tooltip:"The map type to display. Default to roadmap.",items:["roadmap","satellite"].map(function(e){return{text:e,value:e}})},{type:"textarea",name:"style",label:"Style",tooltip:"Custom style to alter the presentation of a specific feature (roads, parks, and other features) of the map",multiline:!0,rows:3},{type:"listbox",name:"format",label:"Format",tooltip:"JPEG typically provides greater compression, while GIF and PNG provide greater detail.",items:["png8","png32","gif","jpg","jpg-baseline"].map(function(e){return{text:e,value:e}})}],this.showDialog=this.showDialog.bind(this),this.init(t,o)}p.prototype.init=function(o,n){let e=this;o.addCommand("beInsertMap",function(s,r,c){o.insertContent(u(c))}),o.ui.registry.addIcon("map",`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 296.999 296.999" xml:space="preserve" width="24px" height="24px">
    <g>
      <path d="M141.914,185.802c1.883,1.656,4.234,2.486,6.587,2.486c2.353,0,4.705-0.83,6.587-2.486 c2.385-2.101,58.391-52.021,58.391-103.793c0-35.842-29.148-65.002-64.977-65.002c-35.83,0-64.979,29.16-64.979,65.002 C83.521,133.781,139.529,183.701,141.914,185.802z M148.501,65.025c9.302,0,16.845,7.602,16.845,16.984 c0,9.381-7.543,16.984-16.845,16.984c-9.305,0-16.847-7.604-16.847-16.984C131.654,72.627,139.196,65.025,148.501,65.025z" fill="#333333"/>
      <path d="M273.357,185.773l-7.527-26.377c-1.222-4.281-5.133-7.232-9.583-7.232h-53.719c-1.942,2.887-3.991,5.785-6.158,8.699 c-15.057,20.23-30.364,33.914-32.061,35.41c-4.37,3.848-9.983,5.967-15.808,5.967c-5.821,0-11.434-2.117-15.81-5.969 c-1.695-1.494-17.004-15.18-32.06-35.408c-2.167-2.914-4.216-5.813-6.158-8.699h-53.72c-4.45,0-8.361,2.951-9.583,7.232 l-8.971,31.436l200.529,36.73L273.357,185.773z" fill="#333333"/>
      <path d="M296.617,267.291l-19.23-67.396l-95.412,80.098h105.06c3.127,0,6.072-1.467,7.955-3.963 C296.873,273.533,297.474,270.297,296.617,267.291z" fill="#333333"/>
      <path d="M48.793,209.888l-30.44-5.576L0.383,267.291c-0.857,3.006-0.256,6.242,1.628,8.738c1.883,2.496,4.828,3.963,7.955,3.963 h38.827V209.888z" fill="#333333"/>
      <polygon points="62.746,212.445 62.746,279.992 160.273,279.992 208.857,239.207" fill="#333333"/>
    </g>
    </svg>`),o.ui.registry.addButton("map",{icon:"map",tooltip:"Insert/edit map",onAction:a=>e.showDialog()}),o.ui.registry.addMenuItem("map",{icon:"map",text:"Map",onAction:a=>e.showDialog(),context:"insert"})},p.prototype.showDialog=function(){let o=this,n=this.editor,e=n.dom,i={},a;if(a=n.selection.getNode(),a){let s=e.getAttrib(a,"src");s||(s=e.getAttrib(a,"data-mce-p-src"));let r=m(s);r.queryKey&&(i=r.queryKey),i.retina==="true"?i.retina=!0:i.retina=!1,i.center||(i.center=i.q||""),i.service="google_staticmap",l.forEach(function(d){let f=l[d];s.indexOf(f.api)>-1&&(i.service=d)}),i.markers&&(i.markers=i.markers.replace(g,"$1")),i.width=e.getAttrib(a,"width"),i.height=e.getAttrib(a,"height")}i.width||(i.width="400"),i.height||(i.height="300"),this.window=null,this.window=this.editor.windowManager.open({title:"Insert a map",size:"medium",initialData:i,body:{type:"panel",items:[{type:"grid",columns:2,items:[{type:"panel",items:this.formFields},{type:"htmlpanel",html:"<div id='map'></div>"}]}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onChange:function(r){o.render()},onSubmit:function(r){o.onsubmit(),r.close()}}),this.render()},p.prototype.onsubmit=function(o){let e=this.window.getData();this.editor.insertContent(u(e))},p.prototype.render=function(o){let n=this.window.getData(),e="";n.key===""?e="<div class='error'>Please enter a Google Maps API key.</div>":e=u(n,!0);let i=$AM.find("#map")[0];return i.innerHTML=e,e},h.PluginManager.add("map",(t,o)=>{let n=new p(t,o);return{getMetadata:()=>({name:"Map - Fully customizable map for your content.",url:"http://www.brandextract.com"})}})})(window.tinymce);})();
//# sourceMappingURL=plugin.min.js.map
